import pandas as pd
import datetime

# --- 1. Данные для Листа "Метаданные Документа" ---
document_id = "reglament_machine_maint_2025_07_01"
document_title = "Регламент Технического Обслуживания Промышленной Машины А-3000"
document_type = "Технический Регламент"
document_date = "2025-07-01"
is_active = True
source_file_name = "Tech_Reglament_A3000_v1.0.pdf"
last_updated = datetime.date.today().strftime("%Y-%m-%d")

df_metadata = pd.DataFrame([{
    "Document_ID": document_id,
    "Document_Title": document_title,
    "Document_Type": document_type,
    "Document_Date": document_date,
    "Is_Active": is_active,
    "Source_File_Name": source_file_name,
    "Last_Updated": last_updated
}])

# --- 2. Данные для Листа "Чанки Регламента" ---
chunks_data = [
    # Глава 1: Замена масла двигателя
    {
        "Chunk_Order": 1,
        "Page_Number": 1,
        "Section_Title": "1. Замена масла двигателя",
        "Chunk_Text_Content": (
            "1.1. **Подготовка к замене масла.** Перед началом работ убедитесь, что двигатель "
            "прогрет до рабочей температуры, что способствует более полному сливу отработанного "
            "масла. Подготовьте необходимые инструменты: ключ для сливной пробки, емкость для "
            "сбора отработанного масла объемом не менее 10 литров, новый масляный фильтр, "
            "ключ для масляного фильтра, воронка и новое моторное масло согласно спецификации "
            "производителя (например, SAE 5W-30, API SN). Защитные перчатки и очки обязательны. "
            "Разместите машину на ровной горизонтальной поверхности или подъемнике."
        )
    },
    {
        "Chunk_Order": 2,
        "Page_Number": 2,
        "Section_Title": "1. Замена масла двигателя",
        "Chunk_Text_Content": (
            "1.2. **Слив отработанного масла.** Установите емкость под сливную пробку масляного "
            "поддона двигателя. Аккуратно открутите сливную пробку, позволяя маслу полностью стечь. "
            "Процесс слива обычно занимает 10-15 минут. После полного слива, очистите сливную "
            "пробку и установите новую уплотнительную шайбу, затем закрутите пробку с моментом "
            "затяжки, указанным в руководстве по эксплуатации (обычно 30-40 Нм). Убедитесь в отсутствии "
            "протечек после затяжки."
        )
    },
    {
        "Chunk_Order": 3,
        "Page_Number": 3,
        "Section_Title": "1. Замена масла двигателя",
        "Chunk_Text_Content": (
            "1.3. **Замена масляного фильтра и заливка нового масла.** Открутите старый масляный "
            "фильтр с помощью специального ключа. Удалите остатки масла из посадочного места. "
            "Нанесите тонкий слой нового масла на уплотнительное кольцо нового фильтра, затем "
            "установите его вручную до упора, после чего затяните еще на 3/4 оборота. Залейте "
            "новое масло через заливную горловину, контролируя уровень по щупу. Запустите двигатель "
            "на несколько минут, затем заглушите и проверьте уровень масла, доливая при необходимости."
        )
    },

    # Глава 2: Замена масла трансмиссии
    {
        "Chunk_Order": 4,
        "Page_Number": 4,
        "Section_Title": "2. Замена масла трансмиссии",
        "Chunk_Text_Content": (
            "2.1. **Определение типа трансмиссии и масла.** Перед началом работ по замене масла "
            "трансмиссии, точно определите тип трансмиссии (механическая, автоматическая, "
            "роботизированная) и требуемый тип трансмиссионного масла согласно руководству "
            "производителя машины. Неправильный тип масла может привести к серьезным повреждениям. "
            "Обеспечьте доступ к сливной и заливной пробкам трансмиссии. Подготовьте чистую "
            "емкость для сбора отработанного масла и шприц для заливки."
        )
    },
    {
        "Chunk_Order": 5,
        "Page_Number": 5,
        "Section_Title": "2. Замена масла трансмиссии",
        "Chunk_Text_Content": (
            "2.2. **Процесс замены.** Установите емкость под сливную пробку. Открутите сливную "
            "пробку и дайте маслу полностью стечь. Для некоторых автоматических трансмиссий может "
            "потребоваться снятие поддона и замена фильтра трансмиссии. После слива, очистите "
            "пробку, замените уплотнительную шайбу и закрутите. Через заливную пробку залейте "
            "новое трансмиссионное масло до необходимого уровня, используя шприц или специальный "
            "насос. Контролируйте уровень по контрольному отверстию или щупу."
        )
    },

    # Глава 3: Ротация колес с учетом запасного
    {
        "Chunk_Order": 6,
        "Page_Number": 6,
        "Section_Title": "3. Ротация колес с учетом запасного",
        "Chunk_Text_Content": (
            "3.1. **Схема ротации колес.** Ротация колес проводится для равномерного износа "
            "всех шин, включая запасное колесо (если оно полноразмерное и участвует в ротации). "
            "Наиболее распространенная схема для переднеприводных машин с запасным колесом "
            "предполагает перемещение передних колес назад по прямой, задних – вперед с "
            "перекрестным расположением, а запасное колесо перемещается на место правого заднего "
            "колеса. Точную схему ротации смотрите в руководстве по эксплуатации вашей машины."
        )
    },
    {
        "Chunk_Order": 7,
        "Page_Number": 7,
        "Section_Title": "3. Ротация колес с учетом запасного",
        "Chunk_Text_Content": (
            "3.2. **Выполнение ротации.** Перед началом работ убедитесь, что машина надежно "
            "зафиксирована и поднята на домкрате или подъемнике. Ослабьте колесные гайки до "
            "подъема машины. Снимите колеса согласно выбранной схеме. При установке колес, "
            "обязательно соблюдайте рекомендованный момент затяжки колесных гаек с использованием "
            "динамометрического ключа (обычно 100-120 Нм). Проверьте давление во всех шинах "
            "и приведите его к рекомендованным значениям."
        )
    },

    # Глава 4: Настройка развала схождения колес
    {
        "Chunk_Order": 8,
        "Page_Number": 8,
        "Section_Title": "4. Настройка развала схождения колес",
        "Chunk_Text_Content": (
            "4.1. **Причины и признаки нарушения регулировки.** Настройка развал-схождения "
            "необходима после ремонта подвески, замены рулевых тяг, попадания в глубокие ямы "
            "или при неравномерном износе шин. Признаками нарушения являются: увод машины в сторону, "
            "неправильное положение руля при движении прямо, повышенный или неравномерный износ шин, "
            "ухудшение управляемости. Регулировка проводится на специализированном стенде."
        )
    },
    {
        "Chunk_Order": 9,
        "Page_Number": 9,
        "Section_Title": "4. Настройка развала схождения колес",
        "Chunk_Text_Content": (
            "4.2. **Процесс регулировки.** Машина устанавливается на стенд развал-схождения. "
            "Специалист подключает датчики к колесам и, используя данные компьютера, регулирует "
            "углы установки колес (развал, схождение, кастер) до соответствия заводским "
            "параметрам. Регулировка выполняется путем изменения длины рулевых тяг и положения "
            "опорных элементов подвески. После завершения регулировки проводится контрольная "
            "проверка и выдается отчет о проделанной работе."
        )
    }
]

df_chunks = pd.DataFrame(chunks_data)

# --- 3. Сохранение в один Excel-файл с двумя листами ---
output_excel_path = f"{document_title.replace(' ', '_').replace("'", "")}_{document_date}.xlsx"

with pd.ExcelWriter(output_excel_path, engine='openpyxl') as writer:
    df_metadata.to_excel(writer, sheet_name='Метаданные Документа', index=False)
    df_chunks.to_excel(writer, sheet_name='Чанки Регламента', index=False)

print(f"Тестовый Excel-файл '{output_excel_path}' успешно сгенерирован.")
print("Он содержит лист 'Метаданные Документа' с общей информацией")
print("и лист 'Чанки Регламента' с текстовыми чанками и их метаданными.")