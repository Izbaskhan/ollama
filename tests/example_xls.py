import pandas as pd
import datetime

# --- 1. Данные для Листа "Метаданные Документа" ---
document_id = "test_reglament_001_2025"
document_title = "Тестовый Регламент 'Порядок обработки запросов'"
document_type = "Регламент"
document_date = "2025-07-01"
is_active = True
source_file_name = "test_reglament_v1.pdf"
last_updated = datetime.date.today().strftime("%Y-%m-%d")

df_metadata = pd.DataFrame([{
    "Document_ID": document_id,
    "Document_Title": document_title,
    "Document_Type": document_type,
    "Document_Date": document_date,
    "Is_Active": is_active,
    "Source_File_Name": source_file_name,
    "Last_Updated": last_updated
}])

# --- 2. Данные для Листа "Чанки Регламента" ---
chunks_data = [
    {
        "Chunk_Order": 1,
        "Page_Number": 1,
        "Section_Title": "Общие положения",
        "Chunk_Text_Content": (
            "1.1. Настоящий Регламент устанавливает единый порядок рассмотрения и обработки "
            "обращений граждан и юридических лиц в организации ООО 'Пример'. "
            "Регламент разработан в целях повышения эффективности работы с обращениями и обеспечения "
            "прозрачности процедур. Все сотрудники, участвующие в процессе обработки запросов, "
            "обязаны ознакомиться с данным документом."
        )
    },
    {
        "Chunk_Order": 2,
        "Page_Number": 1,
        "Section_Title": "Общие положения",
        "Chunk_Text_Content": (
            "1.2. Основными принципами обработки запросов являются законность, справедливость, "
            "беспристрастность и конфиденциальность. Запросы могут поступать в письменной, "
            "электронной форме или в устном виде (по телефону или при личном приеме). "
            "Регистрация всех запросов обязательна в течение одного рабочего дня с момента получения. "
            "Ответственность за своевременную регистрацию возлагается на секретаря отдела."
        )
    },
    {
        "Chunk_Order": 3,
        "Page_Number": 2,
        "Section_Title": "Порядок регистрации",
        "Chunk_Text_Content": (
            "2.1. После получения запроса секретарь производит его первичную регистрацию в "
            "специализированной системе документооборота. При регистрации указываются: дата получения, "
            "ФИО/наименование заявителя, контактные данные, краткое содержание запроса и присвоенный "
            "уникальный входящий номер. Этот номер будет использоваться для отслеживания хода "
            "исполнения обращения. Запросы с неполными данными возвращаются заявителю."
        )
    },
    {
        "Chunk_Order": 4,
        "Page_Number": 2,
        "Section_Title": "Порядок регистрации",
        "Chunk_Text_Content": (
            "2.2. Запросы, поступившие по электронной почте, распечатываются и также регистрируются "
            "в общей системе. Особое внимание уделяется проверке электронной подписи, если таковая "
            "имеется. Ответственность за корректную регистрацию электронных обращений несет "
            "специалист по работе с входящей корреспонденцией. Все этапы обработки фиксируются в системе."
        )
    },
    {
        "Chunk_Order": 5,
        "Page_Number": 3,
        "Section_Title": "Сроки рассмотрения",
        "Chunk_Text_Content": (
            "3.1. Срок рассмотрения запроса не должен превышать 30 календарных дней с момента его "
            "регистрации, если иной срок не установлен законодательством РФ или внутренними "
            "нормативными актами организации. В случае необходимости дополнительной проверки или "
            "получения информации, срок может быть продлен, но не более чем на 15 дней, с "
            "обязательным уведомлением заявителя."
        )
    }
]

df_chunks = pd.DataFrame(chunks_data)

# --- 3. Сохранение в один Excel-файл с двумя листами ---
output_excel_path = f"{document_title.replace(' ', '_').replace("'", "")}_{document_date}.xlsx"

with pd.ExcelWriter(output_excel_path, engine='openpyxl') as writer:
    df_metadata.to_excel(writer, sheet_name='Метаданные Документа', index=False)
    df_chunks.to_excel(writer, sheet_name='Чанки Регламента', index=False)

print(f"Тестовый Excel-файл '{output_excel_path}' успешно сгенерирован.")
print("Он содержит лист 'Метаданные Документа' с общей информацией")
print("и лист 'Чанки Регламента' с текстовыми чанками и их метаданными.")